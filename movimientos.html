<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>DC PayPal – Movimientos</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  background:#f5f6f8;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  margin:0;
  color:#1f2933;
}
header {
  background:#004a9f;
  color:white;
  padding:12px 32px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
nav a {
  color:#e5efff;
  margin:0 12px;
  text-decoration:none;
  border-bottom:2px solid transparent;
  padding-bottom:4px;
}
nav a.active { border-bottom-color:white; }
main { padding:24px 32px; }
.layout {
  display:grid;
  grid-template-columns:1.2fr 2.3fr;
  gap:24px;
}
.card {
  background:white;
  border-radius:12px;
  padding:20px;
  border:1px solid #e5e7eb;
  margin-bottom:18px;
}
.movements {
  margin-top:12px;
  max-height:550px;
  overflow-y:auto;
}
.movement-item {
  display:flex;
  justify-content:space-between;
  padding:10px 0;
  border-bottom:1px solid #e5e7eb;
  font-size:14px;
}
.movement-meta {
  font-size:12px;
  color:#6b7280;
}
.positive { color:#047857; font-weight:600; }
.negative { color:#b91c1c; font-weight:600; }
.pending { color:#1d4ed8; font-weight:600; }

label {
  display:block;
  font-size:13px;
  margin-bottom:4px;
  color:#4b5563;
}
input[type="text"],
input[type="date"],
select {
  width:100%;
  padding:7px 9px;
  border-radius:8px;
  border:1px solid #d1d5db;
  font-size:13px;
  box-sizing:border-box;
}
.form-row {
  margin-bottom:12px;
}
button {
  background:#004a9f;
  color:white;
  border:none;
  padding:8px 14px;
  border-radius:999px;
  font-size:13px;
  cursor:pointer;
}
.summary {
  display:flex;
  gap:18px;
  flex-wrap:wrap;
  font-size:14px;
  margin-top:8px;
}
.summary-item {
  padding:6px 10px;
  border-radius:999px;
  background:#f3f4f6;
}
.summary-item span {
  font-weight:600;
}
</style>
</head>

<body>

<header>
  <strong>DC PayPal</strong>
  <nav>
    <a href="index.html">Inicio</a>
    <a href="enviar.html">Enviar</a>
    <a href="movimientos.html" class="active">Movimientos</a>
    <a href="ayuda.html">Ayuda</a>
  </nav>
  <span>Diego Pedro Cueva Rovelo</span>
</header>

<main>
<div class="layout">

<section>
  <div class="card">
    <h3>Filtros</h3>

    <div class="form-row">
      <label>Buscar por nombre</label>
      <input type="text" id="filtroTexto" placeholder="Ej: Binance, Intigriti, BCP…">
    </div>

    <div class="form-row">
      <label>Tipo de movimiento</label>
      <select id="filtroTipo">
        <option value="todos">Todos</option>
        <option value="ingreso">Ingresos</option>
        <option value="egreso">Egresos</option>
        <option value="pendiente">Pendientes</option>
      </select>
    </div>

    <div class="form-row">
      <label>Desde</label>
      <input type="date" id="desde">
    </div>

    <div class="form-row">
      <label>Hasta</label>
      <input type="date" id="hasta">
    </div>

    <button id="btnAplicar">Aplicar filtros (simulado)</button>

    <p style="font-size:12px;color:#6b7280;margin-top:10px;">
      Los filtros no modifican los datos reales de tu cuenta; solo sirven para analizar
      el flujo de pagos diarios (Binance, Intigriti, BCP, etc.) de forma didáctica.
    </p>
  </div>

  <div class="card">
    <h4>Resumen del período simulado</h4>
    <div class="summary">
      <div class="summary-item">Ingresos: <span id="totalIngresos">PEN 0.00</span></div>
      <div class="summary-item">Egresos: <span id="totalEgresos">PEN 0.00</span></div>
      <div class="summary-item">Balance neto: <span id="balanceNeto">PEN 0.00</span></div>
    </div>
  </div>
</section>

<section>
  <div class="card">
    <h3>Todos los movimientos simulados</h3>
    <div class="movements" id="movements"></div>
  </div>
</section>

</div>
</main>

<script>
const movementsEl = document.getElementById("movements");
const totalIngresosEl = document.getElementById("totalIngresos");
const totalEgresosEl = document.getElementById("totalEgresos");
const balanceNetoEl = document.getElementById("balanceNeto");

const filtroTexto = document.getElementById("filtroTexto");
const filtroTipo = document.getElementById("filtroTipo");
const btnAplicar = document.getElementById("btnAplicar");

function formatDateLabel(d){
  const months=["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"];
  return `${String(d.getDate()).padStart(2,"0")} ${months[d.getMonth()]}`;
}

// Estructura interna para poder filtrar
const movimientos = [];

function addMovement(dateObj, title, metaLabel, displayAmount, type, numericAmount){
  movimientos.push({
    date: new Date(dateObj.getTime()),
    title,
    meta: metaLabel,
    displayAmount,
    type,
    numericAmount
  });
}

// Generación de datos (igual lógica que index, pero guardando info)
const start = new Date(2024,9,10); // 10 oct
const end   = new Date(2024,11,4); // 04 dic

for(let d=new Date(end); d>=start; d.setDate(d.getDate()-1)){

  const label = formatDateLabel(d);

  // Binance gasto diario -500 PEN
  addMovement(d, "Binance Cripto", `${label} · Pago completado`, "-500 PEN", "negative", -500);

  // Intereses Binance
  if(d.getDate()===31 && d.getMonth()===9){
    addMovement(d, "Binance Cripto","31 oct · Intereses Binance","-2,700 PEN","negative",-2700);
  }
  if(d.getDate()===30 && d.getMonth()===10){
    addMovement(d, "Binance Cripto","30 nov · Intereses Binance","-2,700 PEN","negative",-2700);
  }

  // Intigriti depósitos
  if(d > start){
    const nov11 = new Date(2024,10,11);
    let amount = d < nov11
      ? Math.floor(120 + Math.random()*61)
      : Math.floor(298 + Math.random()*118);

    addMovement(d,"Intigriti Cibersecurity",`${label} · Depósito`,`+${amount} PEN`,"positive",amount);
  }

  // TD SYNNEX
  if(d.getDate()===15 && d.getMonth()===9){
    addMovement(d,"TD SYNNEX Symantec","15 oct · Depósito extraordinario","+5,800 PEN","positive",5800);
  }
  if(d.getDate()===15 && d.getMonth()===10){
    addMovement(d,"TD SYNNEX Symantec","15 nov · Depósito extraordinario","+5,800 PEN","positive",5800);
  }

  // Amortización BCP 10 nov
  if(d.getDate()===10 && d.getMonth()===10){
    addMovement(d,"BCP","10 nov · Amortización","-46,800 PEN","negative",-46800);
  }

  // Paquete especial 03 dic
  if(d.getDate()===3 && d.getMonth()===11){
    addMovement(d,"Intigriti Cibersecurity","03 dic · Depósito","+4,370 PEN","positive",4370);
    addMovement(d,"BCP","03 dic · Amortización","-4,370 PEN","negative",-4370);
    addMovement(d,"Binance Cripto","03 dic · Pendiente de liberación","+346 PEN","pending",346);
  }

  // Depósito inicial Binance (10 oct)
  if(d.getTime()===start.getTime()){
    addMovement(d,"Binance Cripto","10 oct · Depósito","+129,114 PEN","positive",129114);
  }
}

// Renderizar y calcular totales
function renderMovimientos(lista){
  movementsEl.innerHTML = "";
  let ingresos = 0;
  let egresos = 0;

  lista.forEach(m => {
    const div = document.createElement("div");
    div.className = "movement-item";
    div.innerHTML = `
      <div>
        <strong>${m.title}</strong>
        <div class="movement-meta">${m.meta}</div>
      </div>
      <span class="${m.type}">${m.displayAmount}</span>
    `;
    movementsEl.appendChild(div);

    if(m.type === "positive") ingresos += m.numericAmount;
    if(m.type === "negative") egresos += Math.abs(m.numericAmount);
  });

  totalIngresosEl.textContent = `PEN ${ingresos.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})}`;
  totalEgresosEl.textContent = `PEN ${egresos.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})}`;
  const balance = ingresos - egresos;
  balanceNetoEl.textContent = `PEN ${balance.toLocaleString("es-PE",{minimumFractionDigits:2,maximumFractionDigits:2})}`;
}

// Filtro simple (texto + tipo). Las fechas son decorativas.
btnAplicar.addEventListener("click", () => {
  const texto = filtroTexto.value.toLowerCase().trim();
  const tipo = filtroTipo.value;

  const filtrados = movimientos.filter(m => {
    if (texto && !m.title.toLowerCase().includes(texto)) return false;
    if (tipo === "ingreso" && m.type !== "positive") return false;
    if (tipo === "egreso" && m.type !== "negative") return false;
    if (tipo === "pendiente" && m.type !== "pending") return false;
    return true;
  });

  renderMovimientos(filtrados);
});

// Render inicial con todos
renderMovimientos(movimientos);
</script>

</body>
</html>

